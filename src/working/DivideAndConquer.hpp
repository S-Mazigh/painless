// TODO using StreamPU Framework or implement a look alike